2025-06-19 02:04:46.563967: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1750323887.133541  359857 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1750323887.301500  359857 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1750323889.102578  359857 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1750323889.102972  359857 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1750323889.103385  359857 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1750323889.103680  359857 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-06-19 02:04:59.631645: E external/local_xla/xla/stream_executor/cuda/cuda_platform.cc:51] failed call to cuInit: INTERNAL: CUDA error: Failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
/global/u1/j/jrobnik/sampler-benchmarks/sampler-comparison/../sampler-evaluation/sampler_evaluation/evaluation/ess.py:42: RuntimeWarning: divide by zero encountered in divide
  return crossing * (1 / cutoff_reached)
/usr/local/lib/python3.12/dist-packages/numpy/lib/_nanfunctions_impl.py:1899: RuntimeWarning: invalid value encountered in subtract
  np.subtract(arr, avg, out=arr, casting='unsafe', where=where)
/global/u1/j/jrobnik/sampler-benchmarks/sampler-comparison/sampler_comparison/samplers/general.py:247: RuntimeWarning: All-NaN slice encountered
  contract_fn = lambda x : np.nanmedian(x, axis=0)
/global/u1/j/jrobnik/sampler-benchmarks/sampler-comparison/../sampler-evaluation/sampler_evaluation/evaluation/ess.py:68: UserWarning: Error always below threshold.
  warnings.warn("Error always below threshold.")
/global/u1/j/jrobnik/sampler-benchmarks/sampler-comparison/sampler_comparison/samplers/general.py:257: RuntimeWarning: All-NaN slice encountered
  grads_to_low_error_resampled = [samples_to_low_error(np.nanmedian(x, axis=0)) for x in resampled_errs]
OpenBLAS warning: precompiled NUM_THREADS exceeded, adding auxiliary array for thread metadata.
To avoid this warning, please rebuild your copy of OpenBLAS with a larger NUM_THREADS setting
or set the environment variable OPENBLAS_NUM_THREADS to 64 or lower
vector_german_credit_numeric_sparse_logistic_regression 0.9950041652780258
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression 0.987567356202793
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression 0.9768263233348374
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression 0.962817004249594
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression 0.9455862716237979
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression 0.9251917764078886
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression 0.9017017549362384
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression 0.8751948006205782
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression 0.8457596009904952
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression 0.813494640960816
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression 0.7785078733186915
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression 0.7409163575328734
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression 0.7008458680936626
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression 0.6584304736939528
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression 0.6138120886593577
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression 0.5671399981282509
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression 0.5185703585703865
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression 0.4682656753152727
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression 0.4163942588383953
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression 0.36312966162446175
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression 0.3086500974918198
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression 0.25313784532088546
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression 0.19677863918160216
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression 0.13976104690045255
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression 0.0822758391462278
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression 0.02451535114548021
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression -0.03332716083675366
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression -0.09105816609786208
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression -0.14848450701678412
Saving results to results/vector_german_credit_numeric_sparse_logistic_regression/adjusted_canonical_nolangevin_nuts_velocity verlet_precond:True_vector_german_credit_numeric_sparse_logistic_regression_cosangle=0.csv
vector_german_credit_numeric_sparse_logistic_regression -0.2054140453248726
Traceback (most recent call last):
  File "/global/u1/j/jrobnik/sampler-benchmarks/sampler-comparison/results/ICG_2_1/main.py", line 44, in <module>
    results = lookup_results(model=model, 
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/global/u1/j/jrobnik/sampler-benchmarks/sampler-comparison/results/run_benchmarks.py", line 195, in lookup_results
    run_benchmarks(
  File "/global/u1/j/jrobnik/sampler-benchmarks/sampler-comparison/results/run_benchmarks.py", line 63, in run_benchmarks
    (stats, _) = sampler_grads_to_low_error(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/global/u1/j/jrobnik/sampler-benchmarks/sampler-comparison/sampler_comparison/samplers/general.py", line 214, in sampler_grads_to_low_error
    grad_evals_per_step = metadata["num_grads_per_proposal"].mean()
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/jax/jax/_src/numpy/array_methods.py", line 247, in _mean
    return reductions.mean(self, axis=axis, dtype=dtype, out=out,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/jax/jax/_src/numpy/reductions.py", line 864, in mean
    return _mean(a, _ensure_optional_axes(axis), dtype, out, keepdims,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/jax/jax/_src/interpreters/pxla.py", line 3172, in cc_shard_arg
    return shard_args([sharding], [layout], [None], [x])[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/jax/jax/_src/profiler.py", line 354, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/jax/jax/_src/interpreters/pxla.py", line 137, in shard_args
    return shard_arg_handlers[type(arg)]([arg], shardings, layouts,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/jax/jax/_src/array.py", line 1229, in _array_shard_arg
    shard_sharded_device_array_slow_path(x, devices, indices, sharding))
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/jax/jax/_src/array.py", line 1172, in shard_sharded_device_array_slow_path
    return pxla.shard_args([sharding], [None], [None], [x._value],
                                                        ^^^^^^^^
  File "/opt/jax/jax/_src/profiler.py", line 354, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/jax/jax/_src/array.py", line 667, in _value
    npy_value[ind], _ = self._arrays[i]._single_device_array_to_np_array_did_copy()
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
Exception ignored in atexit callback: <function clean_up at 0x7efd30777f60>
Traceback (most recent call last):
  File "/opt/jax/jax/_src/api.py", line 3177, in clean_up
    clear_backends()
  File "/opt/jax/jax/_src/api.py", line 3165, in clear_backends
    util.clear_all_caches()
  File "/opt/jax/jax/_src/util.py", line 308, in clear_all_caches
    clear()
  File "<frozen _collections_abc>", line 969, in clear
KeyboardInterrupt: 
